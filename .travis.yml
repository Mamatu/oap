---
matrix:
  fast_finish : true
# OS type
os: linux
dist: trusty
sudo: required
language: cpp

# Compiler selection
compiler:
  - gcc

# Install packages
addons:
  apt:
    packages:
    - google-mock
    - libgtest-dev

#safelist
branches:
  only:
    - master
    - oap2dt3d_development

# Environment variables
env:
  global:
    - OAP_PATH=$TRAVIS_BUILD_DIR
    - GMOCK_DIR=/usr/src/gmock

# Build steps
script:
  - make clean
  - make TARGET_ARCH=HOST
  - ${OAP_PATH}/dist/Debug/x86/bin/oapHostTests
  - make clean
  - make TARGET_ARCH=HOST MODE=DebugSanitizer
  - ${OAP_PATH}/dist/DebugSanitizer/x86/bin/oapHostTests
  - make clean
  - make TARGET_ARCH=HOST
  - ${OAP_PATH}/dist/Debug/x86/bin/oapHostTests
  - ${OAP_PATH}/dist/Debug/x86/bin/oap2dt3dTests
  - make clean
  - make TARGET_ARCH=HOST MODE=DebugSanitizer
  - ${OAP_PATH}/dist/DebugSanitizer/x86/bin/oapHostTests
  - ${OAP_PATH}/dist/DebugSanitizer/x86/bin/oap2dt3dTests
  
# Notify after build
notifications:
  email: false
