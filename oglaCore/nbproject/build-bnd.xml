<?xml version="1.0" encoding="UTF-8"?>
<project name="build-bnd" default="-verify-bundle" basedir="..">
    <description>Generate a bundle for OSGI module</description>

    <target name="-init-bundle">
        <property file="nbproject/bnd.properties" />
    </target>

    <target name="-post-jar-bundle" depends="-init-bundle" description="">
        <echo message="Creating a bundle for moudle" />
        <java classname="aQute.bnd.main.bnd" fork="true">
            <classpath path="${run.classpath}" />
            <arg line=" build -classpath ${build.classes.dir} -noeclipse -output ../ogla/data/core/${bnd.name}-bundle.jar ${bnd.files}" />
        </java>
    </target>

    <target name="-post-jar" depends="-init-bundle,-post-jar-bundle" description="Verify a bundle">
        <echo message="Verifing a bundle for module" />
        <java classname="aQute.bnd.main.bnd" fork="true">
            <classpath path="${run.classpath}" />
            <arg line=" print -verify plugins/${bnd.name}-bundle.jar"/>
        </java>
    </target>

    <target name="-post-jar-dmy" depends="-init-bundle" description="Generate manifest for osgi">
        <echo message="Creating a bundle for module" />
        <taskdef resource="aQute/bnd/ant/taskdef.properties" classpath="/program/bnd.jar"/>
        <bnd classpath="${build.classes.dir}" eclipse="false" failok="false" 
             exceptions="true" files="${bnd.files}"
             output="data/core/${bnd.name}-bundle.jar" />
        <echo message="Created bundle: plugins/${bnd.name}-bundle.jar" />
    </target>

</project>
